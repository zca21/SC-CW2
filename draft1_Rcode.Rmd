---
title: "Untitled"
output: html_document
date: "2022-12-12"
---
```{r}
sample.dexp <- function(n,a,b,s,lamda){
  #Sampling from the double exp function g(x)
  #Using inverse transformation technique
  X <- NULL
  for (i in 1:n) {
      u <- runif(1) 
      if (u<0.5){
        X[i] <- b+log(2*u)/lamda
      }else{
        X[i] <- b-log(2-2*u)/lamda
      }
  }
  
  return(X)
}
dexp.sample <- sample.dexp(10000,2,3,1.25,0.5)
plot(density(dexp.sample))
#Plot looks good (double exp function with mean centered at 3)
#Note that its center (mean) is b and variance or spread is controlled by lambda (b on wiki note lambda=1/b) thus for smaller lambda variance increases
```
```{r}
q1.ar <- function(n,a,b,s,lambda,M){
  
    X <- NULL
    for (i in 1:n){
      repeat{
        #Drawing x from the propsal distibution 
        u <- runif(1)
        if (u<0.5){
          x <- b+log(2*u)/lambda
        }else {
          x <- b-log(2-2*u)/lambda
        }
        #Performing A-R sampling
        y <- runif(1)
        if (s < x){
          if(y <= (a*s^a)/(2*x^(a+1))/(M*lambda*exp(-lambda*abs(x-b))/2)){
            X[i]<-x
            break
          }
        } else if(s-b<x){
          if(y <= 1/(2*b)/(M*lambda*exp(-lambda*abs(x-b))/2)){
            X[i]<-x
            break
          }
        }
      }
    }
    return(X)
}

set.seed(2022)
ar.sample <- q1.ar(5000,2,3,1.25,0.5,M=3.2*exp(0.875))
#Creating function to create actual pdf of target distribution
target.dist <- function(x,a,b,s){
  n<-length(x)
  y<-rep(0,n)
  for (i in 1:n){
  
  if (x[i]<s-b){
    y[i] <- 0
  }else if (x[i]>s){
    y[i] <- (a*s^a)/(2*x[i]^(a+1))
  } else {
    y[i] <- 1/(2*b)
  }
  }
  return(y)
}

#Creating curve of target distribution
hist(ar.sample,nclass=100,prob = T,
     xlab = "Values generated by AR sampling",
     main = "Simulated and actual pdf of target distribution");
curve(target.dist(x,2,3,1.25),from=-4,to=20,n=1000,add=T, lwd= 1.5, lty= 3,col="red");
legend("topright", lty = c(1, 3), cex = 0.6, col = c("black","red"),
legend = c("Simulated pdf", "Actual pdf"))
```










